import requests
import json

# Get input from user
url = input("Enter URL to check: ")
qualys_api_url = input("Enter Qualys API URL: ")
qualys_api_username = input("Enter Qualys API Username: ")
qualys_api_password = input("Enter Qualys API Password: ")

# Make API call to Qualys
headers = {'X-Requested-With': 'Python-Requests', 'Content-Type': 'application/json'}
data = {'url': url}
response = requests.post(f'{qualys_api_url}/api/2.0/fo/was/url/', auth=(qualys_api_username, qualys_api_password), headers=headers, data=json.dumps(data))

# Check if URL is present in Qualys WAS
if 'INVALID_LOGIN' in response.text:
    print('Invalid Qualys API credentials. Please check and try again.')
elif 'INVALID_INPUT' in response.text:
    print('Invalid URL provided. Please check and try again.')
elif '<RESULTS>' in response.text:
    print(f'{url} is present in Qualys WAS.')
else:
    print(f'{url} is not present in Qualys WAS.')
