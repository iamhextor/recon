import requests

# Open file containing URLs
with open('urls.txt', 'r') as f:
    urls = f.readlines()

# Check each URL for insecure transport vulnerability and redirection
for url in urls:
    url = url.strip()  # remove any leading/trailing whitespace

    # Check if URL starts with http:// instead of https://
    if url.startswith('http://'):
        try:
            response = requests.get(url, timeout=5, allow_redirects=True)
            if response.url.startswith('http://'):
                print(f'Insecure transport vulnerability found: {url}')
            elif response.url.startswith('https://'):
                print(f'URL is secure: {url}')
        except requests.exceptions.RequestException as e:
            print(f'Error checking URL: {url}. Error: {e}')
