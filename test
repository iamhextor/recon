import requests
import json

# Get input from user
url = input("Enter URL to check: ")

# Use provided Qualys API URL and credentials
qualys_api_url = 'https://abc.com/qps/rest/3.0'
qualys_api_username = 'admin'
qualys_api_password = 'password'

# Make API call to Qualys
headers = {'Content-Type': 'application/json'}
params = {'action': 'list', 'url': url}
response = requests.get(f'{qualys_api_url}/url/', auth=(qualys_api_username, qualys_api_password), headers=headers, params=params)

# Check if URL is present in Qualys WAS
if response.status_code == 401:
    print('Invalid Qualys API credentials. Please check and try again.')
else:
    data = response.json()
    if data['responseCode'] == 'INVALID_INPUT':
        print('Invalid URL provided. Please check and try again.')
    elif data['responseCode'] == 'SUCCESS':
        if data['count'] > 0:
            print(f'{url} is present in Qualys WAS.')
        else:
            print(f'{url} is not present in Qualys WAS.')
    else:
        print(f'Error: {data["message"]}')
