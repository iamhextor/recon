import requests

# path to the file containing the list of URLs
urls_file = "urls.txt"

# headers to send with the requests
headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3'
}

# loop through each URL in the file and send a request to check for cookies
with open(urls_file, "r") as f:
    urls = f.readlines()

for url in urls:
    url = url.strip()
    try:
        response = requests.get(url, headers=headers, allow_redirects=False)
        cookies = response.cookies
        # check if the response contains any cookies that were issued without user consent
        for cookie in cookies:
            if not cookie.has_nonstandard_attr('SameSite') and cookie.domain.startswith('.'):
                print(f"Vulnerable cookie detected on {url}: {cookie}")
    except:
        print(f"Error checking {url}")
